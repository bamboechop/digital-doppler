---
import { Image } from 'astro:assets';
import SingleNote from './SingleNote.astro';
import { notes } from 'astro:db';

interface Props {
  completedNotes: notes[];
  openNotes: notes[];
  userId: string;
}
const { completedNotes, openNotes, userId } = Astro.props;
---

<section class="flex flex-col p-4">
  <section class="[border-image:url('/bg/border.png');] [border-image-slice:255!important;] single-note-box bg-neutral-800 bg-background-fabric border-[24px] border-amber-950 rounded-2xl flex flex-col gap-4 pb-4 shadow-2xl z-[1]">
    <header class="bg-yellow-900 bg-background-pattern max-w-max p-2 font-bold">
      Heutige Todos (<span id="open-notes-amount">{openNotes.length}</span>/3)
    </header>
    <section
      class="flex flex-wrap gap-2 px-6"
      id="open-notes">
      {openNotes.length < 3 && <SingleNote type="new" userId={userId} />}
      {openNotes.map((note) => (
        <SingleNote noteId={note.note_id} text={note.text} type={note.status} userId={note.user_id} />
      ))}
    </section>
  </section>
  <Image
    alt=""
    class="self-end my-1 scale-x-[-1] drop-shadow-stationery"
    height="32px"
    src="/stationeries/pencil-gray.png"
    width="666px" />
  <section class="[border-image:url('/bg/border.png');] [border-image-slice:255!important;] single-note-box bg-lime-700 bg-background-fabric border-[24px] border-amber-950 rounded-2xl flex flex-col gap-4 pb-4 basis-full shadow-2xl">
    <header class="bg-yellow-900 bg-background-pattern max-w-max p-2 font-bold">
      Abgeschlossene Todos (<span id="closed-notes-amount">{completedNotes.length}</span>)
    </header>
    <section
      class="flex flex-wrap gap-2 h-full px-6 relative"
      id="completed-notes">
      {completedNotes.map((note) => (
        <SingleNote
          noteId={note.note_id}
          text={note.text}
          type={note.status} />
      ))}
    </section>
  </section>
</section>

<style lang="scss">
  .single-note-box {
    position: relative;

    &::before {
      bottom: 0;
      box-shadow: inset 0 0 50px 15px rgba(0,0,0,0.5);
      content: '';
      left: 0;
      pointer-events: none;
      position: absolute;
      right: 0;
      top: 0;
      z-index: 1;
    }
  }
</style>
